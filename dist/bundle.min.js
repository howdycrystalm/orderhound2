angular.module("app",["ui.router"]).config(["$stateProvider","$urlRouterProvider",function(e,t){e.state("login",{url:"/login",templateUrl:"./app/routes/login/login.html",controller:"loginCtrl"}).state("home",{url:"/home",templateUrl:"./app/routes/home/home.html",controller:"homeCtrl",resolve:{user:["mainService","$state",function(e,t){return e.getCurrentUser().then(function(e){return e.data.email?e.data:t.go("login")}).catch(function(e){t.go("login")})}],poNumber:["mainService","$state",function(e,t){return e.getPo()}]}}).state("adminHome",{url:"/adminHome",templateUrl:"./app/routes/adminHome/adminHome.html",controller:"adminHomeCtrl",resolve:{user:["mainService","$state",function(e,t){return e.getCurrentUser().then(function(e){return e.data.email?e.data:t.go("login")}).catch(function(e){t.go("login")})}]}}).state("manageUser",{url:"/manageUser",templateUrl:"./app/routes/manage/manageUser.html",controller:"manageUserCtrl",resolve:{user:["mainService","$state",function(e,t){return e.getCurrentUser().then(function(e){return e.data.email?e.data:t.go("login")}).catch(function(e){t.go("login")})}]}}),t.otherwise("/login")}]),angular.module("app").service("mainService",["$http",function(e){this.login=function(t){return e({method:"post",url:"/api/login",data:t}).then(function(e){return e})},this.logout=function(){return e({method:"get",url:"/api/logout"}).then(function(e){return e})},this.getCurrentUser=function(){return e({method:"GET",url:"/api/me"}).then(function(e){return e})},this.register=function(t){return e({method:"POST",url:"/api/register",data:t}).then(function(e){return e})},this.addUser=function(t){return e({method:"POST",url:"/api/addUser",data:t}).then(function(e){return e})},this.getter=function(t){return e({method:"POST",url:"/api/addUser",data:user}).then(function(e){return e})},this.getPo=function(){return e({method:"POST",url:"/api/getPo"}).then(function(e){return e})}}]),angular.module("app").controller("searchCtrl",["$scope","mainService","$state",function(e,t,r){e.po_search=function(n){t.po_search(po).then(function(t){return t.data?void r.go("location"):(e.po.num="",alert("PO does not exist"))})}}]),angular.module("app").directive("searchDirective",function(){return{restrict:"AE",templateUrl:"./app/directives/search/searchTmpl.html",controller:"searchCtrl"}}),angular.module("app").controller("searchCtrl",["$scope","mainService","purchaseOrders",function(e,t,r){e.purchaseOrders=r,console.log(r)}]),angular.module("app").directive("searchDirective",function(){return{restrict:"AE",templateUrl:"./app/directives/search/searchTmpl.html",controller:"searchCtrl"}}),angular.module("app").controller("adminHomeCtrl",["$scope","mainService","user","$state",function(e,t,r,n){e.user=r,e.obj={},e.logout=function(){t.logout().then(function(e){n.go("login")})},e.register=function(e){t.register(e).then(function(e){return"User created successfully!"!==e.data?alert("Could not register user"):void alert(e.data)}).catch(function(e){return alert("Could not register user")})}}]),angular.module("app").controller("homeCtrl",["$scope","$state","mainService","homeService","user","poNumber",function(e,t,r,n,o,a){e.user=o,e.addpo=function(e){n.addpo(e).then(function(e){alert("PO added successfully"),t.reload("home")})},e.findpo=function(r){n.findpo(r).then(function(r){alert("PO found!"),console.log(r),e.mattFsesh=r,t.reload("home")})},e.login=function(n){r.login(n).then(function(r){return r.data?("true"===r.data.admin?t.go("adminHome"):t.go("home"),void console.log(r.data.admin)):(e.user.password="",alert("user could not be logged in"))}).catch(function(t){e.user.password="",alert("user could not be logged in")})},e.logout=function(){r.logout().then(function(e){t.go("login")})}}]),angular.module("app").service("homeService",["$http",function(e){this.addpo=function(t){return e({method:"POST",url:"/api/checkin",data:{ponumber:t,checkpoint_id:1}}).then(function(e){return e.data})},this.findpo=function(t){return e({method:"GET",url:"/api/getPo/"+t}).then(function(e){return e.data})}}]),angular.module("app").controller("loginCtrl",["$scope","mainService","$state",function(e,t,r){e.test="login",e.login=function(n){t.login(n).then(function(t){return t.data?("true"===t.data.admin?r.go("adminHome"):r.go("home"),void console.log(t.data.admin)):(e.user.password="",alert("user could not be logged in"))}).catch(function(t){e.user.password="",alert("user could not be logged in")})},e.register=function(e){t.register(e).then(function(e){return"User created successfully!"!==e.data?alert("Could not register user"):void alert(e.data)}).catch(function(e){return alert("Could not register user")})}}]),angular.module("app").controller("manageUserCtrl",["$scope","$state","mainService",function(e,t,r){e.obj={},e.getter=function(e){r.addUser(e).then(function(e){e.data?e.data&&(alert("User Created!"),t.reload("manageUser")):alert("Unable to create user")}).catch(function(e){alert("Unable to create user")})}}]);